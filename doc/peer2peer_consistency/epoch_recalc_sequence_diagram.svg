<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1777.5px" preserveAspectRatio="none" style="width:1590px;height:1777px;background:#FFFFFF;" version="1.1" viewBox="0 0 1590 1777" width="1590px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1749.3633" style="stroke:#181818;stroke-width:0.75;" width="721.9724" x="152.2888" y="9"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="91.5205" x="467.5148" y="27.1003">ingester</text><rect fill="#DDDDDD" height="1749.3633" style="stroke:#181818;stroke-width:0.75;" width="156.2212" x="938.9788" y="9"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="93.2344" x="970.4722" y="27.1003">DB layer</text><rect fill="#DDDDDD" height="1749.3633" style="stroke:#181818;stroke-width:0.75;" width="391.6187" x="1163.9912" y="9"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="95.5957" x="1312.0027" y="27.1003">RocksDB</text><rect fill="none" height="69.3984" style="stroke:#000000;stroke-width:2.25;" width="634.6311" x="929.9788" y="422.2852"/><rect fill="none" height="268.3945" style="stroke:#000000;stroke-width:2.25;" width="883.2612" x="15" y="577.3828"/><rect fill="none" height="155.2969" style="stroke:#000000;stroke-width:2.25;" width="739.9724" x="143.2888" y="679.9805"/><rect fill="none" height="69.3984" style="stroke:#000000;stroke-width:2.25;" width="534.4973" x="293.22" y="1125.7734"/><rect fill="none" height="135.3047" style="stroke:#000000;stroke-width:2.25;" width="841.6553" x="722.9546" y="1475.168"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="79.5" x2="79.5" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="200.2888" x2="200.2888" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="359.22" x2="359.22" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="495.8694" x2="495.8694" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="623.5964" x2="623.5964" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="802.4546" x2="802.4546" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="1016.9788" x2="1016.9788" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="1214.9912" x2="1214.9912" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="1340.6558" x2="1340.6558" y1="155.5898" y2="1635.9727"/><line style="stroke:#181818;stroke-width:0.75;stroke-dasharray:5.0,5.0;" x1="1484.8828" x2="1484.8828" y1="155.5898" y2="1635.9727"/><path d="M37.5,91.6992 L123.5596,91.6992 C131.0596,91.6992 131.0596,123.6445 131.0596,123.6445 C131.0596,123.6445 131.0596,155.5898 123.5596,155.5898 L37.5,155.5898 C30,155.5898 30,123.6445 30,123.6445 C30,123.6445 30,91.6992 37.5,91.6992 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.75;"/><path d="M123.5596,91.6992 C116.0596,91.6992 116.0596,123.6445 116.0596,123.6445 C116.0596,155.5898 123.5596,155.5898 123.5596,155.5898 " fill="none" style="stroke:#181818;stroke-width:0.75;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="71.0596" x="37.5" y="118.6919">Solana</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="47.3013" x="49.3792" y="143.1372">data</text><path d="M37.5,1634.4727 L123.5596,1634.4727 C131.0596,1634.4727 131.0596,1666.418 131.0596,1666.418 C131.0596,1666.418 131.0596,1698.3633 123.5596,1698.3633 L37.5,1698.3633 C30,1698.3633 30,1666.418 30,1666.418 C30,1666.418 30,1634.4727 37.5,1634.4727 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.75;"/><path d="M123.5596,1634.4727 C116.0596,1634.4727 116.0596,1666.418 116.0596,1666.418 C116.0596,1698.3633 123.5596,1698.3633 123.5596,1698.3633 " fill="none" style="stroke:#181818;stroke-width:0.75;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="71.0596" x="37.5" y="1661.4653">Solana</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="47.3013" x="49.3792" y="1685.9106">data</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="71.0596" x="161.5649" y="126.1919">Solana</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="77.6118" x="158.2888" y="150.6372">Service</text><ellipse cx="201.5947" cy="82.6992" fill="#E2E2F0" rx="18" ry="18" style="stroke:#181818;stroke-width:0.75;"/><polygon fill="#181818" points="195.5947,64.6992,204.5947,57.1992,201.5947,64.6992,204.5947,72.1992,195.5947,64.6992" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="71.0596" x="161.5649" y="1653.9653">Solana</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="77.6118" x="158.2888" y="1678.4106">Service</text><ellipse cx="201.5947" cy="1707.3633" fill="#E2E2F0" rx="18" ry="18" style="stroke:#181818;stroke-width:0.75;"/><polygon fill="#181818" points="195.5947,1689.3633,204.5947,1681.8633,201.5947,1689.3633,204.5947,1696.8633,195.5947,1689.3633" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="102.1494" x="308.22" y="84.1992"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="45.7222" x="336.4336" y="114.1919">Fork</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="81.1494" x="318.72" y="138.6372">Cleaner</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="102.1494" x="308.22" y="1634.4727"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="45.7222" x="336.4336" y="1664.4653">Fork</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="81.1494" x="318.72" y="1688.9106">Cleaner</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="141.2271" x="425.3694" y="84.1992"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="435.8694" y="114.1919">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="101.9751" x="444.9954" y="138.6372">Processor</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="141.2271" x="425.3694" y="1634.4727"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="435.8694" y="1664.4653">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="101.9751" x="444.9954" y="1688.9106">Processor</text><path d="M589.0964,116.1445 L660.3699,116.1445 C667.8699,116.1445 667.8699,135.8672 667.8699,135.8672 C667.8699,135.8672 667.8699,155.5898 660.3699,155.5898 L589.0964,155.5898 C581.5964,155.5898 581.5964,135.8672 581.5964,135.8672 C581.5964,135.8672 581.5964,116.1445 589.0964,116.1445 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.75;"/><path d="M660.3699,116.1445 C652.8699,116.1445 652.8699,135.8672 652.8699,135.8672 C652.8699,155.5898 660.3699,155.5898 660.3699,155.5898 " fill="none" style="stroke:#181818;stroke-width:0.75;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="56.2734" x="589.0964" y="143.1372">mpsc</text><path d="M589.0964,1634.4727 L660.3699,1634.4727 C667.8699,1634.4727 667.8699,1654.1953 667.8699,1654.1953 C667.8699,1654.1953 667.8699,1673.918 660.3699,1673.918 L589.0964,1673.918 C581.5964,1673.918 581.5964,1654.1953 581.5964,1654.1953 C581.5964,1654.1953 581.5964,1634.4727 589.0964,1634.4727 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.75;"/><path d="M660.3699,1634.4727 C652.8699,1634.4727 652.8699,1654.1953 652.8699,1654.1953 C652.8699,1673.918 660.3699,1673.918 660.3699,1673.918 " fill="none" style="stroke:#181818;stroke-width:0.75;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="56.2734" x="589.0964" y="1661.4653">mpsc</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="130.3066" x="737.9546" y="84.1992"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="109.3066" x="748.4546" y="114.1919">Checksum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="106.6406" x="749.7876" y="138.6372">Calculator</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="130.3066" x="737.9546" y="1634.4727"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="109.3066" x="748.4546" y="1664.4653">Checksum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="106.6406" x="749.7876" y="1688.9106">Calculator</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="144.2212" x="944.9788" y="84.1992"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="123.2212" x="955.4788" y="114.1919">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="57.6782" x="988.2502" y="138.6372">client</text><rect fill="#E2E2F0" height="69.8906" rx="3.75" ry="3.75" style="stroke:#181818;stroke-width:0.75;" width="144.2212" x="944.9788" y="1634.4727"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="123.2212" x="955.4788" y="1664.4653">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="57.6782" x="988.2502" y="1688.9106">client</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="68.3423" x="1176.9023" y="126.1919">Assets</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="82.1646" x="1169.9912" y="150.6372">Storage</text><path d="M1188.5735,52.6992 C1188.5735,37.6992 1215.5735,37.6992 1215.5735,37.6992 C1215.5735,37.6992 1242.5735,37.6992 1242.5735,52.6992 L1242.5735,91.6992 C1242.5735,106.6992 1215.5735,106.6992 1215.5735,106.6992 C1215.5735,106.6992 1188.5735,106.6992 1188.5735,91.6992 L1188.5735,52.6992 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1188.5735,52.6992 C1188.5735,67.6992 1215.5735,67.6992 1215.5735,67.6992 C1215.5735,67.6992 1242.5735,67.6992 1242.5735,52.6992 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="68.3423" x="1176.9023" y="1653.9653">Assets</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="82.1646" x="1169.9912" y="1678.4106">Storage</text><path d="M1188.5735,1698.3633 C1188.5735,1683.3633 1215.5735,1683.3633 1215.5735,1683.3633 C1215.5735,1683.3633 1242.5735,1683.3633 1242.5735,1698.3633 L1242.5735,1737.3633 C1242.5735,1752.3633 1215.5735,1752.3633 1215.5735,1752.3633 C1215.5735,1752.3633 1188.5735,1752.3633 1188.5735,1737.3633 L1188.5735,1698.3633 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1188.5735,1698.3633 C1188.5735,1713.3633 1215.5735,1713.3633 1215.5735,1713.3633 C1215.5735,1713.3633 1242.5735,1713.3633 1242.5735,1698.3633 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="1276.1558" y="126.1919">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="88.2246" x="1292.157" y="150.6372">changes</text><path d="M1313.7693,52.6992 C1313.7693,37.6992 1340.7693,37.6992 1340.7693,37.6992 C1340.7693,37.6992 1367.7693,37.6992 1367.7693,52.6992 L1367.7693,91.6992 C1367.7693,106.6992 1340.7693,106.6992 1340.7693,106.6992 C1340.7693,106.6992 1313.7693,106.6992 1313.7693,91.6992 L1313.7693,52.6992 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1313.7693,52.6992 C1313.7693,67.6992 1340.7693,67.6992 1340.7693,67.6992 C1340.7693,67.6992 1367.7693,67.6992 1367.7693,52.6992 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="1276.1558" y="1653.9653">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="88.2246" x="1292.157" y="1678.4106">changes</text><path d="M1313.7693,1698.3633 C1313.7693,1683.3633 1340.7693,1683.3633 1340.7693,1683.3633 C1340.7693,1683.3633 1367.7693,1683.3633 1367.7693,1698.3633 L1367.7693,1737.3633 C1367.7693,1752.3633 1340.7693,1752.3633 1340.7693,1752.3633 C1340.7693,1752.3633 1313.7693,1752.3633 1313.7693,1737.3633 L1313.7693,1698.3633 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1313.7693,1698.3633 C1313.7693,1713.3633 1340.7693,1713.3633 1340.7693,1713.3633 C1340.7693,1713.3633 1367.7693,1713.3633 1367.7693,1698.3633 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="1420.3828" y="126.1919">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="74.8945" x="1443.0491" y="150.6372">epochs</text><path d="M1457.9963,52.6992 C1457.9963,37.6992 1484.9963,37.6992 1484.9963,37.6992 C1484.9963,37.6992 1511.9963,37.6992 1511.9963,52.6992 L1511.9963,91.6992 C1511.9963,106.6992 1484.9963,106.6992 1484.9963,106.6992 C1484.9963,106.6992 1457.9963,106.6992 1457.9963,91.6992 L1457.9963,52.6992 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1457.9963,52.6992 C1457.9963,67.6992 1484.9963,67.6992 1484.9963,67.6992 C1484.9963,67.6992 1511.9963,67.6992 1511.9963,52.6992 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="120.2271" x="1420.3828" y="1653.9653">Bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="74.8945" x="1443.0491" y="1678.4106">epochs</text><path d="M1457.9963,1698.3633 C1457.9963,1683.3633 1484.9963,1683.3633 1484.9963,1683.3633 C1484.9963,1683.3633 1511.9963,1683.3633 1511.9963,1698.3633 L1511.9963,1737.3633 C1511.9963,1752.3633 1484.9963,1752.3633 1484.9963,1752.3633 C1484.9963,1752.3633 1457.9963,1752.3633 1457.9963,1737.3633 L1457.9963,1698.3633 " fill="#E2E2F0" style="stroke:#181818;stroke-width:2.25;"/><path d="M1457.9963,1698.3633 C1457.9963,1713.3633 1484.9963,1713.3633 1484.9963,1713.3633 C1484.9963,1713.3633 1511.9963,1713.3633 1511.9963,1698.3633 " fill="none" style="stroke:#181818;stroke-width:2.25;"/><rect fill="#EEEEEE" height="4.5" style="stroke:#EEEEEE;stroke-width:1.5;" width="1579.6099" x="0" y="201.4395"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="201.4395" y2="201.4395"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="205.9395" y2="205.9395"/><rect fill="#EEEEEE" height="34.6992" style="stroke:#000000;stroke-width:3.0;" width="370.3337" x="604.6381" y="185.5898"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="342.5449" x="613.6381" y="209.6902">Process bubblegum instruction</text><polygon fill="#181818" points="477.9829,260.9883,492.9829,266.9883,477.9829,272.9883,483.9829,266.9883" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="80.5298" x2="486.9829" y1="266.9883" y2="266.9883"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="352.1711" x="91.0298" y="259.3894">process next bubblegum instruction</text><polygon fill="#181818" points="999.0894,304.6875,1014.0894,310.6875,999.0894,316.6875,1005.0894,310.6875" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="495.9829" x2="1008.0894" y1="310.6875" y2="310.6875"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="85.3506" x="506.4829" y="303.0886">call save</text><polygon fill="#181818" points="1197.5735,393.7852,1212.5735,399.7852,1197.5735,405.7852,1203.5735,399.7852" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="1017.0894" x2="1206.5735" y1="399.7852" y2="399.7852"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="162.4841" x="1027.5894" y="346.7878">save bubblegum</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="129.873" x="1027.5894" y="369.4871">asset change</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="81.6277" x="1027.5894" y="392.1863">in Rocks</text><path d="M929.9788,422.2852 L1402.199,422.2852 L1402.199,432.9844 L1387.199,447.9844 L929.9788,447.9844 L929.9788,422.2852 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.25;"/><rect fill="none" height="69.3984" style="stroke:#000000;stroke-width:2.25;" width="634.6311" x="929.9788" y="422.2852"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="404.7202" x="952.4788" y="441.8855">if epoch(msg.slot) &lt; current_epoch()</text><polygon fill="#181818" points="1466.9963,473.6836,1481.9963,479.6836,1466.9963,485.6836,1472.9963,479.6836" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="1017.0894" x2="1475.9963" y1="479.6836" y2="479.6836"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="291.4717" x="1027.5894" y="472.0847">mark the epoch INVALIDATED</text><rect fill="#EEEEEE" height="4.5" style="stroke:#EEEEEE;stroke-width:1.5;" width="1579.6099" x="0" y="533.0332"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="533.0332" y2="533.0332"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="537.5332" y2="537.5332"/><rect fill="#EEEEEE" height="34.6992" style="stroke:#000000;stroke-width:3.0;" width="269.4346" x="655.0876" y="517.1836"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="241.6458" x="664.0876" y="541.2839">Triggering calculation</text><path d="M15,577.3828 L129.936,577.3828 L129.936,588.082 L114.936,603.082 L15,603.082 L15,577.3828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.25;"/><rect fill="none" height="268.3945" style="stroke:#000000;stroke-width:2.25;" width="883.2612" x="15" y="577.3828"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="47.436" x="37.5" y="596.9832">loop</text><polygon fill="#181818" points="183.5947,651.4805,198.5947,657.4805,183.5947,663.4805,189.5947,657.4805" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="80.5298" x2="192.5947" y1="657.4805" y2="657.4805"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="73.3916" x="91.0298" y="627.1824">get last</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="85.0649" x="91.0298" y="649.8816">slot num</text><path d="M143.2888,679.9805 L562.2173,679.9805 L562.2173,690.6797 L547.2173,705.6797 L143.2888,705.6797 L143.2888,679.9805 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.25;"/><rect fill="none" height="155.2969" style="stroke:#000000;stroke-width:2.25;" width="739.9724" x="143.2888" y="679.9805"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="351.4285" x="165.7888" y="699.5808">if epoch(slot) &gt; current_epoch()</text><line style="stroke:#181818;stroke-width:1.5;" x1="201.5947" x2="264.5947" y1="760.0781" y2="760.0781"/><line style="stroke:#181818;stroke-width:1.5;" x1="264.5947" x2="264.5947" y1="760.0781" y2="779.5781"/><line style="stroke:#181818;stroke-width:1.5;" x1="203.0947" x2="264.5947" y1="779.5781" y2="779.5781"/><polygon fill="#181818" points="218.0947,773.5781,203.0947,779.5781,218.0947,785.5781,212.0947,779.5781" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="99.509" x="212.0947" y="729.78">increment</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="136.7" x="212.0947" y="752.4792">current epoch</text><polygon fill="#181818" points="785.1079,817.2773,800.1079,823.2773,785.1079,829.2773,791.1079,823.2773" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="201.5947" x2="794.1079" y1="823.2773" y2="823.2773"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="116.3049" x="212.0947" y="815.6785">Calc(epoch)</text><rect fill="#EEEEEE" height="4.5" style="stroke:#EEEEEE;stroke-width:1.5;" width="1579.6099" x="0" y="887.127"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="887.127" y2="887.127"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="891.627" y2="891.627"/><rect fill="#EEEEEE" height="34.6992" style="stroke:#000000;stroke-width:3.0;" width="188.521" x="695.5444" y="871.2773"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="160.7322" x="704.5444" y="895.3777">Forks cleaning</text><polygon fill="#181818" points="375.7947,946.6758,360.7947,952.6758,375.7947,958.6758,369.7947,952.6758" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="366.7947" x2="1214.0735" y1="952.6758" y2="952.6758"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="112.1917" x="384.7947" y="945.0769">assets data</text><line style="stroke:#181818;stroke-width:1.5;" x1="359.2947" x2="422.2947" y1="996.375" y2="996.375"/><line style="stroke:#181818;stroke-width:1.5;" x1="422.2947" x2="422.2947" y1="996.375" y2="1015.875"/><line style="stroke:#181818;stroke-width:1.5;" x1="360.7947" x2="422.2947" y1="1015.875" y2="1015.875"/><polygon fill="#181818" points="375.7947,1009.875,360.7947,1015.875,375.7947,1021.875,369.7947,1015.875" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="91.4824" x="369.7947" y="988.7761">find forks</text><polygon fill="#181818" points="1197.5735,1053.5742,1212.5735,1059.5742,1197.5735,1065.5742,1203.5735,1059.5742" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="359.2947" x2="1206.5735" y1="1059.5742" y2="1059.5742"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="99.1663" x="369.7947" y="1051.9753">drop forks</text><polygon fill="#181818" points="1322.7693,1097.2734,1337.7693,1103.2734,1322.7693,1109.2734,1328.7693,1103.2734" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="359.2947" x2="1331.7693" y1="1103.2734" y2="1103.2734"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="595.3118" x="369.7947" y="1095.6746">remove bubble change records for forked assets instructions</text><path d="M293.22,1125.7734 L820.2173,1125.7734 L820.2173,1136.4727 L805.2173,1151.4727 L293.22,1151.4727 L293.22,1125.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.25;"/><rect fill="none" height="69.3984" style="stroke:#000000;stroke-width:2.25;" width="534.4973" x="293.22" y="1125.7734"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="459.4973" x="315.72" y="1145.3738">if epoch(forked_ix.slot) &lt; current_epoch()</text><polygon fill="#181818" points="606.7332,1177.1719,621.7332,1183.1719,606.7332,1189.1719,612.7332,1183.1719" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="359.2947" x2="615.7332" y1="1183.1719" y2="1183.1719"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="166.426" x="369.7947" y="1175.573">Calc(Tree,epoch)</text><rect fill="#EEEEEE" height="4.5" style="stroke:#EEEEEE;stroke-width:1.5;" width="1579.6099" x="0" y="1236.5215"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="1236.5215" y2="1236.5215"/><line style="stroke:#000000;stroke-width:1.5;" x1="0" x2="1579.6099" y1="1241.0215" y2="1241.0215"/><rect fill="#EEEEEE" height="34.6992" style="stroke:#000000;stroke-width:3.0;" width="401.6118" x="588.999" y="1220.6719"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="373.823" x="597.999" y="1244.7722">Calculation of an epoch checksum</text><polygon fill="#181818" points="785.1079,1296.0703,800.1079,1302.0703,785.1079,1308.0703,791.1079,1302.0703" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="624.7332" x2="794.1079" y1="1302.0703" y2="1302.0703"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="142.3748" x="635.2332" y="1294.4714">read next cmd</text><polygon fill="#181818" points="1466.9963,1339.7695,1481.9963,1345.7695,1466.9963,1351.7695,1472.9963,1345.7695" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="803.1079" x2="1475.9963" y1="1345.7695" y2="1345.7695"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="193.7241" x="813.6079" y="1338.1707">mark CALCULATING</text><polygon fill="#181818" points="819.6079,1383.4688,804.6079,1389.4688,819.6079,1395.4688,813.6079,1389.4688" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="810.6079" x2="1339.2693" y1="1389.4688" y2="1389.4688"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="265.4685" x="828.6079" y="1381.8699">fetch changes in the epoch</text><line style="stroke:#181818;stroke-width:1.5;" x1="803.1079" x2="866.1079" y1="1433.168" y2="1433.168"/><line style="stroke:#181818;stroke-width:1.5;" x1="866.1079" x2="866.1079" y1="1433.168" y2="1452.668"/><line style="stroke:#181818;stroke-width:1.5;" x1="804.6079" x2="866.1079" y1="1452.668" y2="1452.668"/><polygon fill="#181818" points="819.6079,1446.668,804.6079,1452.668,819.6079,1458.668,813.6079,1452.668" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="192.9814" x="813.6079" y="1425.5691">calculate checksum</text><path d="M722.9546,1475.168 L819.6189,1475.168 L819.6189,1485.8672 L804.6189,1500.8672 L722.9546,1500.8672 L722.9546,1475.168 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.25;"/><rect fill="none" height="135.3047" style="stroke:#000000;stroke-width:2.25;" width="841.6553" x="722.9546" y="1475.168"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="29.1643" x="745.4546" y="1494.7683">alt</text><text fill="#000000" font-family="sans-serif" font-size="16.5" font-weight="bold" lengthAdjust="spacing" textLength="293.9626" x="842.1189" y="1493.4836">[if checksum == CALCULATING]</text><polygon fill="#181818" points="1466.9963,1526.5664,1481.9963,1532.5664,1466.9963,1538.5664,1472.9963,1532.5664" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="803.1079" x2="1475.9963" y1="1532.5664" y2="1532.5664"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="455.4507" x="813.6079" y="1524.9675">merge: write checksum if it was CALCULATING</text><line style="stroke:#000000;stroke-width:1.5;stroke-dasharray:2.0,2.0;" x1="722.9546" x2="1564.6099" y1="1546.0664" y2="1546.0664"/><text fill="#000000" font-family="sans-serif" font-size="16.5" font-weight="bold" lengthAdjust="spacing" textLength="532.407" x="730.4546" y="1561.3821">[checksum == INVALIDATED (another change appeared)]</text><polygon fill="#181818" points="1466.9963,1592.4727,1481.9963,1598.4727,1466.9963,1604.4727,1472.9963,1598.4727" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="803.1079" x2="1475.9963" y1="1598.4727" y2="1598.4727"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="358.0364" x="813.6079" y="1590.8738">mark CALCULATING and re-calculate</text><!--SRC=[ZLLDJzmm4BtxLumuiL91wg4Nn28jMLeX8LILRK-HaDUPpLeuTcexGFzzntOIyWLYBvkCPzxCUpFZEC4LmjVpR-nlWmt2oODHNFDS5zpp4-0Eac5dkNPSU6cqOtlp2bANw3nQ1lGJHdjhr5lq0zfdAN00q5gYUysjbqBMN7iu-MxiKwupXLoZZG71qhxFtQ-R_LvXsLIv_ccDGETCYkeFUdCCRcbLjHFHBJpCKRCZYYSNG3EkHAEuRr6xWs1cg0iWxf7_zXeK_xTKuK2gN0ibKVjnWLjkHb2_3ANONaUa8FkUEwfuunnwHr9IARnCKYPRQvdu3uGHHnwwCywQ9UFxKLWRSPm4tKHRNorRhw6L5_QT3us2yxQ9X66zPcm-CN1sjT0Vk82w1TFuwfSHsKBS48t491oQOWMEFoCR7P3ZI3Bo34vlcNBDmpaanN8jTUe6AwrfQf07YAgSLguyTyhu5Lo2QAobdZwcarKKT9fr8Y3bhRXz0d_410YtztysTxVRpUvc6zMD-QA-EolB4YtjLs0LPx4JLXbJlwFkQCaeNKca57S-rw5iq4qrfPJeN2tI6QCjm4ijB5OKHiEMuXFgSlHmYIWu_9r6zzM0UtYA18C8uGfm8C8b48G8v0Ut0boUpVeQ- -ZYP8zSAVtmzG8EaX8T0lxKRmfPM5ClUqwNYfn93jDFLZjFP1J65Yw0H20ikZe74-xOj3N9zL6-VZXpavh2nTQ9kxE8NsOA1s6pmKYP0t3TpgDeMnIbZb3plbdaHTfKKHMCZKxVd_biSvVzljliRkz_Z4EeYGiw7j37Sj8xxME_CxE4a_AwRS6U3EFA1rK7v4Rb11K_mG9jYHVmOkK0Ei1A3o_X4p50HELmb6wmvt3AjI4sjfiENjV8BHQhpnOoaPEwLr1JpdhYeTV_0G00]--></g></svg>